:doctitle: The ESPD Request Document
:doccode: espd-tech-prod-015
:author: NPJ
:authoremail: nicole-anne.paterson-jones@ext.ec.europa.eu
:docdate: January 2024

== ESPD Request Business Requirements

The ESPD-EDM models the business and information requirements in alignment with the works developed by e-Sens, which uses the identifier *Trdm070* to refer to the business requirements regarding the ESPD Request transaction. See formal information requirements related to the ESPD Request transaction in the document link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-BusinessRequirements:ESPDrequesttransaction(Trdm070)[_Business Requirements: ESPD request transaction (Trdm070)_], by e-Sens.

include::partial$piraeus.adoc[]

== ESPD Request XSD Schema

The ESPD-EDM uses the UBL-2.3 document named QualificationApplicationRequest.xsd XSD Schema. This schema can be found under the GitHub folder https://github.com/OP-TED/ESPD-EDM/tree/master/ubl-2.3/xsdrt/maindoc[ubl-2.3/xsdrt/maindoc] (or the equivalent documented xsd folder).

The figure below shows the XSD Schema defined by UBL-2.3 for the document "Qualification Application Request". This schema replaces the previous scheme form UBL 2.2.

The figure below shows a diagram representing the UBL-2.3 XSD Schema. Only the first level components of the schema are shown. The inner sub-elements and sub-classes are covered in detail in the following sub-sections of this document.

image::https://kroki.io/blockdiag/svg/eNrtVttuEzEQfd-vGC0vILm5tJWoWoFUcpEilRJ6gYeqihx7suvitRfbW5JWfecr-Di-BHujTRPa9EaEQOrb7JmZ4_HojGeHUrMvXNAELqN6Hfo0Qag7ZKkSjMrSGhj8WqB1tdRlEnrZbyEDERBb_1hQKUYeckKrwW6ey8o-mOavrdc2amd5Ai-7IikMQrO5DQtZc0lzOZBRoQAlZqicrb0KdR6iA5tTBRk6I8YRQPk5-Ca4S-ENbG7tzLAURZI6DzbXS5DjiBbSDUba04kLDJ7N4IkSo4scLtDowdS8jCKmpTY-JH7RaXS7u6_jnSiK76n6aJJjDGtvIcax2z5-t9cZO1TWB9iYQMyGLICf0ASo166wVmGdzsRFSXUN940eCYk3gM4YWbEYOsel80lP8VCXNrNDj-cDlDOUua6WHI3H4YSLcFGlFZ4-4orzZPs0wwUiApIOUYb-NWq1n99_xI-l7llbYJs6nN0xAEciC8AUudHIvsFzoQt7i0Mz5F57Lc1nhMvKCXWUcX_Smc-l-A6ZNkIl79GlmntBJZN97VbdqelR_piVFL7qAum1SnyJfWrcZBl982n0HaaVHx_2IUcTVH_nGU-8QhCQl094ibx5hsw9vcm30u1pV-rSO49Q-cn0zWoZ4byhVeXZ5VwETirbPj9kH-AIDSqGVcihSBR1nvveBkT_0yNFbnlvyD_zUJAHzDxZNqxkbu7IkoEhdymdLJUo-Xtqi66iaj9Pd7HTXnkcLan2LpxTWSAI6_fx1gPn5cSmNA-LeqjHBKolv7HeILCwxU93ntX8rOZVvp2V8PzvoGfki_prNLzgrn4B_a3fDg==[QualificationApplicationRequest-2.3,width=550,height=1000]
//image:Qualification_Application_Request-2.3.jpg[QualificationApplicationRequest-2.3,width=297,height=462]
//[Edit this diagram](https://niolesk.top/#https://kroki.io/blockdiag/svg/eNrtVttuEzEQfd-vGC0vILm5tJWoWoFUcpEilRJ6gYeqihx7suvitRfbW5JWfecr-Di-BHujTRPa9EaEQOrb7JmZ4_HojGeHUrMvXNAELqN6Hfo0Qag7ZKkSjMrSGhj8WqB1tdRlEnrZbyEDERBb_1hQKUYeckKrwW6ey8o-mOavrdc2amd5Ai-7IikMQrO5DQtZc0lzOZBRoQAlZqicrb0KdR6iA5tTBRk6I8YRQPk5-Ca4S-ENbG7tzLAURZI6DzbXS5DjiBbSDUba04kLDJ7N4IkSo4scLtDowdS8jCKmpTY-JH7RaXS7u6_jnSiK76n6aJJjDGtvIcax2z5-t9cZO1TWB9iYQMyGLICf0ASo166wVmGdzsRFSXUN940eCYk3gM4YWbEYOsel80lP8VCXNrNDj-cDlDOUua6WHI3H4YSLcFGlFZ4-4orzZPs0wwUiApIOUYb-NWq1n99_xI-l7llbYJs6nN0xAEciC8AUudHIvsFzoQt7i0Mz5F57Lc1nhMvKCXWUcX_Smc-l-A6ZNkIl79GlmntBJZN97VbdqelR_piVFL7qAum1SnyJfWrcZBl982n0HaaVHx_2IUcTVH_nGU-8QhCQl094ibx5hsw9vcm30u1pV-rSO49Q-cn0zWoZ4byhVeXZ5VwETirbPj9kH-AIDSqGVcihSBR1nvveBkT_0yNFbnlvyD_zUJAHzDxZNqxkbu7IkoEhdymdLJUo-Xtqi66iaj9Pd7HTXnkcLan2LpxTWSAI6_fx1gPn5cSmNA-LeqjHBKolv7HeILCwxU93ntX8rOZVvp2V8PzvoGfki_prNLzgrn4B_a3fDg==)
_Figure 11: QualificationApplicationRequest-2.3 main elements._

== ESPD Request cardinalities

The UBL-2.3 Schema is quite flexible as, except for in a few cases, all the elements are optional.

The ESPD-EDM model, however, adds a few more restrictions regarding the cardinalities of some elements. These can be seen in the diagram below, which presents the ESPD-EDM structure for the ESPD Request with its cardinality restrictions.

image:Qualification_ApplicationRequest_UML_diagram.jpg[QualificationApplicationRequest', UML diagram,width=394,height=430]

_Figure 12. ESPD-EDM 'QualificationApplicationRequest', UML diagram_

Comparing both figures, it can be observed that:

[arabic]
. The cardinalities of the root common basic components, such as cbc:ID, cbc:UUID, differ in the ESPD from in UBL-2.3;
. Similarly, the cardinalities of aggregate components like cac:ContractingParty and cac:TenderingCriterion also differ in the ESPD from in UBL-2.3.

The cardinality constraints added by the ESPD are not defined in the XSD Schema. To control these constraints, the ESPD-EDM uses link:https://schematron.com/[ISO Schematron] assertions. The ESPD-EDM distribution package provides Schematron schemata and CVA files for the validation of the XML instances (folder link:{url-tree}/validation[_/validation_]).

== Root elements

The tables below establish a mapping between the business requirements, the logic layer of the ESPD-EDM, and the UBL-2.3 physical layer. They list the elements that are expected in the ESPD Request and provide details on the cardinalities and usage of those elements.

[cols=",",options="header",]

[IMPORTANT]
====
_A note about the Business Rules identifiers_

From this point in the document, the tables defining classes and its properties refer frequently to business rules. As stated in the link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-BusinessRules[e-Sens BIS document], "[..] business rules are sets of rules that clarify the content of instances by stating mandatory fields, fixed values (like code lists), dependency between fields in the same object, and dependency between different objects".

Information requirement:

Note that *all theses documents share the same business rule identifiers* (e.g. tbrxx-yyy for Business Requirement Identifiers in ESPDInt, and BR-Type-Id#n for the Test Cases technical rules).
====

The mapping between the business requirements, the logic layer of the ESPD-EDM, and the UBL-2.3 physical layer:

_Table 5. Class QualificationApplicationRequest, components required by the ESPD-EDM_
|===
|*Document name:* |*QualificationApplicationRequest*
+
|*Definition 1*: a|
"_A structured electronic business document for requesting qualification information through an ESPD (conform to an ESPD template). Directive 2014/24/EU, Art. 59._" (source: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-BusinessRequirements:ESPDrequesttransaction(Trdm070)[_ESPD Request transaction (Trdm070)_]).

Document provided by a buyer defining the exclusion and selection criteria for a given procurement procedure.

|*Business rule(s)*: |None
|*File*: |link:{url-tree}/ubl-2.3/xsd/maindoc/[/ubl-2.3/xsd/maindoc/UBL-QualificationApplicationRequest-2.3.xsd]
|===



[cols="10h,10h,10h,35h,~"]
//[%autowidth]
|===
s|Components|Type|Card|Description|Requirements
+
|*cbc:UBLVersionID* |Identifier |1 |Identifies the earliest version of the UBL 2 schema for this document type that defines all of the elements that might be encountered in the current instance. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: Use the value "2.3". Use also "OASIS-UBL-TC" for the schemeAgencyID attribute.

*Rule scope*: Common (BR-OTH-05, 2.BR-OTH-02)

|*cbc:ProfileExecutionID* |Identifier |1 |The identification and version of the ESPD Exchange Data Model used to create the XML instance. The identification may include the exact version of the specification. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: Compulsory use of the CodeList ProfileExecutionID. Use the value "OP" for th SchemeAgencyID attribute.

*Rule scope*: Common (BR-OTH-01, BR-OTH-01#13, BR-OTH-03)

|*cbc:ID* |Identifier |1 |An identifier for this document, normally generated by the system that creates the ESPD document, or the organisation responsible for the document (e.g. the buyer, e.g. a buyer, or the supplier, e.g. an economic operator). An identifier for this document, normally generated by the system that creates the ESPD document, or the organisation responsible for the document (e.g. the buyer, e.g. a buyer, or the supplier, e.g. an economic operator). The identifier enables positive referencing the document instance for various purposes including referencing between transactions that are part of the same process. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: Compulsory use of schemeAgencyID attribute. Use it to identify the organisation responsible for the document.

*Rule scope*: Common (BR-OTH-02)

|*cbc:CopyIndicator* |Indicator |0..1 |Indicates whether this document is a copy (true) or not (false). +
ESPD definition: this component enables to keep track of the event of having forwarded the same document several times to the same or to different destinations. + 
Additional comments: copies of an ESPD document should be identified with same UUIDs.a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: It is a good practice to use the CopyIndicator component if the same document is forwarded several times to the same or to different destinations. Use it in combination with the UUID identifier: copies of an ESPD document should be identified with same UUIDs.

|*cbc:UUID* |Identifier |1 |A universally unique identifier that can be used to reference this ESPD document instance. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: This UUID will be used to link the ESPD Response to its corresponding ESPD Request (thus it being compulsory). Copies of a document must be identified with a different UUID. Compulsory use of schemeAgencyID attribute.

*Rule scope*: BR-OTH-02

|*cbc:ContractFolderID* |Identifier |1 |An identifier that is specified by the buyer and used as a reference number for all documents in the procurement process. It is also known as procurement project identifier, procurement reference number or contract folder identifier. A reference to the procurement procedure to which a Qualification request document and the delivered response documents are associated. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: Try always to use the reference number issued by the buyer. This information will be provided in eForms using the same cbc:ContractFolderID, therefore the ESPD should include the same identifier in order to link both models, and shall be globally unique.

This number in combination with a registered buyer ID (e.g. the VAT number) results in a *universally unique identifier of the procurement procedure*.

*Rule scope*: BR-SC-10

|*cbc:IssueDate* |Date |1 |Date when the document was issued by the buyer. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: Format "YYYY-MM-DD".

|*cbc:IssueTime* |Time |0..1 |Time when the document was issued by the buyer. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr070-002_].

*Rule*: Format "hh:mm:ss".

|*cbc:VersionID* |Identifier |0..1 |The version identifying the content of this document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-014[_tbr070-014_].

*Rule*: Changes in content should entail the modification of the version identifier and a reference to the previous version.

|*cbc:PreviousVersionID* |Identifier |0..1 |The version identifying the previous modification of the content of this document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-014[_tbr070-014_].

*Rule*: None

|*cbc:ProcedureCode* |Code |1 |The type of the procurement administrative procedure according to the EU Directives. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: For the ESPD, this information will be linked to eForms. And ESPD should include the same procedure code as the one stated in eForms notices.

|*cac:ContractingParty* |Associated class |1 |The buyer or contracting entity who is buying supplies, services or public works using a tendering procedure as described in the applicable directive (Directives 2014/24/EU, 2014/25/EU). a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-01[_tbr070-01_].

*Rule*: UBL-2.3 defines multiple cardinality ContractingParties presumably to allow *joint procurements*. However the ESPD only expects data about one buyer. The decision was made that in case of joint procurement the data collected in the ESPD would be about *the leader* of the joint procurement procedure.

In ESPD the contracting party information will come from eForms. Which also uses cac:ContractingParty to specify the information about buyer.

|*cac:ProcurementProject/

cbc:Description* 
|Text |1 |Text describing this procurement project. |This element is required in the ESPD, however it should be identical to that provided in eForms. In general the corresponding eForm should feed the corresponding ESPD with the corresponding data.

|*cac:TenderingCriterion* |Associated class |1..n |A tendering criterion describes a rule or a condition that is used by the contracting body to evaluate and compare tenders by economic operators and which will be used for the exclusion and the selection of candidates to the award decision. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr70-003[_tbr70-003, tbr70-009_].

*Rule*: (see examples further below in this document)

|*cac:TenderingCriterion/

cac:ProcurementProject
LotReference/cbc:ID* |Identifier |0..n |One or more of the procurement project lots Identifier to which this criterion can be related to. a|
*Information Requirement*: (see section <<lot_management>>)

*Rule*: This element is mandatory for all Selection Criteria with cardinality 1..n because different Selection Criteria can be associated with different procurement lots. This element is not necessary for exclusion grounds because exclusion grounds are applied to all procurements.

|*cac:AdditionalDocument
Reference* |Associated class |0..n |A reference to an additional document associated with this document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr70-007[_tbr70-007_].

*Rule*: *For procurement procedures above the threshold it is compulsory to make reference to the Contract Notice of the procedure published in TED*. See section "Reference to the Contract Notice" for a complete example.

|===


[[lot_management, Lot Management]]
== Lot Management

The ESPD includes a change as to how lots are managed. This is an outcome of the alignment with eForms.

In this version the ESPD has the following logic:

There is one ESPD request stating the Exclusion Criteria and the Selection Criteria, but with differences with respect to version 2.1.1. The figure below shows the logic:

image:Overview_new_lot_management_approach.jpg[Overview of new lot management approach.,width=497,height=129]

_Figure 13. Overview of new lot management approach._

The ESPD request includes exclusion grounds that are general for all the Lots into which the procedure is divided. However, for Selection Criteria, it is different since in the procedure it is possible to have Lots with different selection criteria. Therefore, in the ESPD request the different Selection Criteria has to include the reference to the lots which applies. It will be done using the UBL 2.3 cac:ProcurementProjectLotReference that includes cbc:TenderingCriterion.

The following XML example shows how it is done:

[source,xml]
----
<!--- Root elements eliminated for the sake of brevity -->

<cac:TenderingCriterion>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">499efc97-2ac1-4af2-9e84-323c2ca67747</cbc:ID>
<cbc:CriterionTypeCode listID="http://publications.europa.eu/resource/authority/criterion" listAgencyID="OP" listVersionID="20230315-0">gen-year-to</cbc:CriterionTypeCode>
<cbc:Name>General yearly turnover</cbc:Name>
<cbc:Description>Its general yearly turnover for the number of financial years required in the relevant notice, the in the ESPD, the relevant notice or the ESPD is as follows:</cbc:Description>
<cac:ProcurementProjectLotReference>
<cbc:ID schemeID="Criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">LOT-00000</cbc:ID>
</cac:ProcurementProjectLotReference>
<cac:ProcurementProjectLotReference>
<cbc:ID schemeID="Criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">LOT-00001</cbc:ID>
</cac:ProcurementProjectLotReference>
<cac:SubTenderingCriterion>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">e6b21867-95b5-4549-8180-f4673219b179</cbc:ID>
<cbc:Name>[Name of the National Criterion]</cbc:Name>
<cbc:Description>[Description of the National Criterion ]</cbc:Description>
<cac:TenderingCriterionPropertyGroup>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">8c39b505-8abe-44fa-a3e0-f2d78b9d8224</cbc:ID>
<cbc:PropertyGroupTypeCode listID="property-group-type" listAgencyID="OP" listVersionID="3.3.0">ON*</cbc:PropertyGroupTypeCode>
<cac:TenderingCriterionProperty>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">ed2a13ed-cf3d-478e-888d-cb9b89f55020</cbc:ID>
<cbc:Description>[Additional information; e.g. no evidences online]</cbc:Description>
<cbc:TypeCode listID="criterion-element-type" listAgencyID="OP" listVersionID="3.3.0">CAPTION</cbc:TypeCode>
<cbc:ValueDataTypeCode listID="response-data-type" listAgencyID="OP" listVersionID="3.3.0">NONE</cbc:ValueDataTypeCode>
</cac:TenderingCriterionProperty>
<cac:TenderingCriterionProperty>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">b21ab072-e5b6-495c-ad6e-4ead6993ede5</cbc:ID>
<cbc:Description>Your Answer</cbc:Description>
<cbc:TypeCode listID="criterion-element-type" listAgencyID="OP" listVersionID="3.3.0">QUESTION</cbc:TypeCode>
<cbc:ValueDataTypeCode listID="response-data-type" listAgencyID="OP" listVersionID="3.3.0">INDICATOR</cbc:ValueDataTypeCode>
</cac:TenderingCriterionProperty>
</cac:TenderingCriterionPropertyGroup>
</cac:SubTenderingCriterion>
<cac:Legislation>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">635a537c-57bf-4beb-8b69-d97d49382e1f</cbc:ID>
<cbc:Title>[Legislation title]</cbc:Title>
<cbc:Description>[Legislation description]</cbc:Description>
<cbc:JurisdictionLevel>EU</cbc:JurisdictionLevel>
<cbc:Article>[Article, e.g. Article 2.I.a]</cbc:Article>
<cbc:URI>http://eur-lex.europa.eu/</cbc:URI>
<cac:Language>
<cbc:LocaleCode listID="http://publications.europa.eu/resource/authority/language" listAgencyName="OP" listVersionID="20220928-0">ENG</cbc:LocaleCode>
</cac:Language>
</cac:Legislation>
<cac:TenderingCriterionPropertyGroup>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">5ca58d66-3ef1-4145-957c-45d5b18a837f</cbc:ID>
<cbc:PropertyGroupTypeCode listID="property-group-type" listAgencyID="OP" listVersionID="3.3.0">ON*</cbc:PropertyGroupTypeCode>
<cac:TenderingCriterionProperty>
<cbc:ID schemeID="criterion" schemeAgencyID="OP" schemeVersionID="3.3.0">42824f1f-3574-4e53-80ca-501d22e85ef8</cbc:ID>
<cbc:Description>Minimum requirement</cbc:Description>
<cbc:TypeCode listID="criterion-element-type" listAgencyID="OP" listVersionID="3.3.0">REQUIREMENT</cbc:TypeCode>
<cbc:ValueDataTypeCode listID="response-data-type" listAgencyID="OP" listVersionID="3.3.0">AMOUNT</cbc:ValueDataTypeCode>
<!-- No answer is expected here from the economic operator, as this is a REQUIREMENT issued by the buyer. Hence the element 'cbc:ValueDataTypeCode' contains the type of value of the requirement issued by the buyer -->
<cbc:ExpectedAmount currencyID="EUR">100000</cbc:ExpectedAmount>
</cac:TenderingCriterionProperty>

<!--- Rest of the elements of the criterion have been eliminated for the sake of brevity -->
----

From the Economic Operator's side it is different. As in the image above there will be as many ESPD Responses as Lots, or Group of Lots, the EO wishes to tender for. If the EO wishes to participate in three Lots, they will need to fill in 3 ESPD Responses. For more details on this, please see the section on the ESPD Response.

=== Lot identifiers

This version of the ESPD changes the form to identify Lots and Groups of Lots, taking the eForms format. This changes is done with the aim of improving the interoperability of both models.

Up to version 2.1.1, the lots were identified with the following structure, "Lot1, Lot2, Lot3". With the new approach (eForms), the Lots identifiers will be as follows: 

image:Lot_ID_schema.jpg[Lot Identifiers according to eForms schema,width=541,height=130]

_Figure 14: Lot Identifiers according to eForms schema_

== EU and notice publications

[cols=",",]
|===
|*REQUIREMENT* link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_] |*The Buyer must be able to provide information about official journals or gazettes where the procurement procedure is announced. For procurement projects above the threshold it is compulsory to refer to the Contract Notice published in link:https://ted.europa.eu/TED/[TED].*
|===

Software applications that conform to the ESPD will have to provide the means for the user to supply references to EU and notice publications about the procurement procedure, especially about Notices to which the ESPD is related.

=== Mock-up

The Figure below is a mock-up of how to collect the data expected to reference publications on official gazettes or journals. This mechanism can, of course, also be used for contracts below the threshold.

image:Publications_mock-up.jpg[Publications mock-up,width=500,height=459]

_Figure 14. Publications, mock-up_

=== XSD Schema

The ESPD EDM uses the UBL component cac:AdditionalDocumentReference to allow the inclusion of references to documents that might be considered relevant, amongst them the reference to the Contract Notice on the TED (for above-the-threshold contracts), and to possible Notices on national journals and boards.

The class used for this, cac:AdditionalDocumentReference ''is a'' cac:DocumentReference class defined in the UBL-2.3 Common Aggregate Components library).

image::https://kroki.io/blockdiag/svg/eNrtVdtqGzEQffZ-xaBSaGFjr51AUocWkrgLhkDd3AiEYOTVeFeNVtpK2tZOyHu_oh_XL6m09q5zoUkoKXmpH4x8NHPmojPjiVDJBeM0haug04ERTRE6FpNM8oSK6jTW-LVEY9uZzQUM8zsmY-4R00loMlBJmaO0BzhFjTLB8enh4HUv8vya5u0vRQpvYp6WGqHb7cPnkgo-dSyWK7lTFGJ5PFgEXOu11yGnXAIK9Lym_dYneYgWTEEl5Gg1nwUA1c_xd85sBu9hY2u7wTLkaWYd2O1VIMMpLYUdT5Wj45fobzb8TZBqVRZwiVqNF8erIEiUUNqZkFcfozje2STbQUAIrH0A4srt7zDGfb5U3KucwBnj3lUqiSEIOkHhiaJ2-9ePn-Q8eJzAR8GZ7R_v7n-cWZTGGRoSutCTpD8c1Kc9VcyHkvnWKV2Dx8crg6ExJQ6oxVvAEc8boA5-NC9wTzEkT8zurm_NdzqiNnumDni-BmK10VBa1M7JuWs0TVf2qUxLp8ZV8fvKaXRR1BI5Qe07uTKpOQ8ttaWpTG-mfv4XzRigSTQvvP1ztcEbWUuTzF9WqTvkxM2Pc5yPUHPFarR6Xz2i2s5r6ACNU_2nqSu-Gbg7VS4HYMq1sc0EtMi9fKqHhjOT0cJPjzOUDNlEzUKoB7C3GYXGzoW_Z9RkyEJYjdJuN457XXK-HbRasMIngiYXZAFap_uVQxxH7kOq-V1-6uiCS7yF34q6IKu-XmqSwsemJHwhiYd_Vmz4b-QWtK6D66Be4AutWOXUx9CE9WKGb1SUCNy4hb3ld20jNPcnkivJbqgsCqFZ773I6ekJS_lB2b67ybhRMf6XzUvL5uE3W6-e6fo3WpjlRw==[cac:DocumentReference, XSD diagram,width=600,height=750]
//image:cacDocumentReference_XSD diagram.jpg[cac:DocumentReference, XSD diagram,width=424,height=458]
//[Edit this diagram](https://niolesk.top/#https://kroki.io/blockdiag/svg/eNrtVdtqGzEQffZ-xaBSaGFjr51AUocWkrgLhkDd3AiEYOTVeFeNVtpK2tZOyHu_oh_XL6m09q5zoUkoKXmpH4x8NHPmojPjiVDJBeM0haug04ERTRE6FpNM8oSK6jTW-LVEY9uZzQUM8zsmY-4R00loMlBJmaO0BzhFjTLB8enh4HUv8vya5u0vRQpvYp6WGqHb7cPnkgo-dSyWK7lTFGJ5PFgEXOu11yGnXAIK9Lym_dYneYgWTEEl5Gg1nwUA1c_xd85sBu9hY2u7wTLkaWYd2O1VIMMpLYUdT5Wj45fobzb8TZBqVRZwiVqNF8erIEiUUNqZkFcfozje2STbQUAIrH0A4srt7zDGfb5U3KucwBnj3lUqiSEIOkHhiaJ2-9ePn-Q8eJzAR8GZ7R_v7n-cWZTGGRoSutCTpD8c1Kc9VcyHkvnWKV2Dx8crg6ExJQ6oxVvAEc8boA5-NC9wTzEkT8zurm_NdzqiNnumDni-BmK10VBa1M7JuWs0TVf2qUxLp8ZV8fvKaXRR1BI5Qe07uTKpOQ8ttaWpTG-mfv4XzRigSTQvvP1ztcEbWUuTzF9WqTvkxM2Pc5yPUHPFarR6Xz2i2s5r6ACNU_2nqSu-Gbg7VS4HYMq1sc0EtMi9fKqHhjOT0cJPjzOUDNlEzUKoB7C3GYXGzoW_Z9RkyEJYjdJuN457XXK-HbRasMIngiYXZAFap_uVQxxH7kOq-V1-6uiCS7yF34q6IKu-XmqSwsemJHwhiYd_Vmz4b-QWtK6D66Be4AutWOXUx9CE9WKGb1SUCNy4hb3ld20jNPcnkivJbqgsCqFZ773I6ekJS_lB2b67ybhRMf6XzUvL5uE3W6-e6fo3WpjlRw==)
_Figure 15. cac:DocumentReference, XSD diagram_

The class cac:AdditionalDocumentReference aggregates a subclass cac:Attachment that is used by ESPD to place the URI, the name of the document, and the descriptions.

image::https://kroki.io/blockdiag/svg/eNrlVdtuEzEQfd79CmsREkhLbir0JpBS2hWVKKBeJCRURY492XXrtYPtQNIq73wFH8eXMN50N7dt06dKiDys7OPxXI7PZPpSs2suaEpuw2aTfKEpkKYDlinBqCxWPQPfR2BdI3O5JMf5iklPeMQ2u9ZqJqgD3mOSWvu802KUHY0dGEXlKQzAgGLQ-3p2iEc-pKF542qYkheJSEcGSPtNg8y9kMILQR97a05igl7InY-XPvEzcMQOqSI5OCPGISHFtvdTcJeRt2RrZ7_CMhBp5hBsdwqQw4COpOsNtHJW3IA_2SpOwtTo0ZDcgNG92fI2DJmW2qBN9OyolSTd7Wg_DKOIvHpHIp9sl3PhhMZ0DzUb5aBclXZEvnHhryqtsAZJ-yC9o1aj8efX7-gS_Wz0UIVxjrLMHy55rXwsHPsrMHZ7FwcfPZPKom8bxeinj9zmfeAceBnqQChqJp_7V8DcfTYFXvcutanUWNVmRMpwF6fH5bKM-IHarMT8uitTbYTL8hNwmeZVouOhMJNDlM8yci7yCjnB9XvNq32iTU7dInKkmOZCpYvY-4wayrAQFNrSbSHhE81XK3-o8KIusMyIoX_lzaKYKW8gjHWVCoNKhX1J2TVqMHDI6FybSdLCn8dtRode01Io8Fs3kX7LkUbgCAQBCj1YVU0YhMEsmAWmFZ9HDqK52flk6EsvQ6CJQp309TgmZee1t1vxcsyYzNM8aCdJpx1d3uWxXpVH76vMn61UV0D1FfrvU_VBiOFmhLlMmEXygmjN-jEk7j6axHtYfJDGOh7ribxjspbKf7uB4_XODH2d0xA__jsNp-WkmT2L09izHGxcThDyg8oREGFxsuz4mVC9KY6qHJto_qCdVkyqOdRp4dM93V_0Q0Lr7Ba5bBpD8doQiv8HQWzg7rXnbvoX3IX6fg==[Associated class cac:ExternalReference XSD diagram,width=850,height=600]
//image:Associated_class cacExternalReference_XSD diagram.jpg[Associated class cac:ExternalReference XSD diagram,width=531,height=308]
//[Edit this diagram](https://niolesk.top/#https://kroki.io/blockdiag/svg/eNrlVdtuEzEQfd79CmsREkhLbir0JpBS2hWVKKBeJCRURY492XXrtYPtQNIq73wFH8eXMN50N7dt06dKiDys7OPxXI7PZPpSs2suaEpuw2aTfKEpkKYDlinBqCxWPQPfR2BdI3O5JMf5iklPeMQ2u9ZqJqgD3mOSWvu802KUHY0dGEXlKQzAgGLQ-3p2iEc-pKF542qYkheJSEcGSPtNg8y9kMILQR97a05igl7InY-XPvEzcMQOqSI5OCPGISHFtvdTcJeRt2RrZ7_CMhBp5hBsdwqQw4COpOsNtHJW3IA_2SpOwtTo0ZDcgNG92fI2DJmW2qBN9OyolSTd7Wg_DKOIvHpHIp9sl3PhhMZ0DzUb5aBclXZEvnHhryqtsAZJ-yC9o1aj8efX7-gS_Wz0UIVxjrLMHy55rXwsHPsrMHZ7FwcfPZPKom8bxeinj9zmfeAceBnqQChqJp_7V8DcfTYFXvcutanUWNVmRMpwF6fH5bKM-IHarMT8uitTbYTL8hNwmeZVouOhMJNDlM8yci7yCjnB9XvNq32iTU7dInKkmOZCpYvY-4wayrAQFNrSbSHhE81XK3-o8KIusMyIoX_lzaKYKW8gjHWVCoNKhX1J2TVqMHDI6FybSdLCn8dtRode01Io8Fs3kX7LkUbgCAQBCj1YVU0YhMEsmAWmFZ9HDqK52flk6EsvQ6CJQp309TgmZee1t1vxcsyYzNM8aCdJpx1d3uWxXpVH76vMn61UV0D1FfrvU_VBiOFmhLlMmEXygmjN-jEk7j6axHtYfJDGOh7ribxjspbKf7uB4_XODH2d0xA__jsNp-WkmT2L09izHGxcThDyg8oREGFxsuz4mVC9KY6qHJto_qCdVkyqOdRp4dM93V_0Q0Lr7Ba5bBpD8doQiv8HQWzg7rXnbvoX3IX6fg==)
_Figure 16. Associated class cac:ExternalReference, XSD diagram_

=== Expected elements

As can be seen from the XSD Schema, the cac:DocumentReference class has a rich data structure. However, to refer to publications such as the TED and national publications, the ESPD expects, at least, the following data:

The mapping between the business requirements, the logic layer of the ESPD-EDM, and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 6. Reference to additional documents, expected elements_
|===
|*Class name*: |cac:AdditionalDocumentReference
|*Definition*: |A reference to an additional document associated with this document.
|*Business rule(s)*: |Common (BR-COM-10)
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/cac:AdditionalDocumentReference
|*Context of Use*: |In this case this reference points at a document published on the Supplement of the European Official Journal or on a national journal.
|===

[cols=",,,,",options="header",]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:ID* |Identifier |1 |The identifier for the referenced document, generally issued by the entity responsible for the document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: If the document referenced is a Contract Notice published on TED, the ID must follow the scheme defined by the Publications Office: [][][][]/S [][][]-[][][][][][] (e.g. 2015/S 252-461137). If, at the time of drafting the ESPD document, the Publication Office has not yet published the Contract Notice, the value 0000/S 000-000000 value must be used to indicate that a temporary identifier is being used.

*Rule scope*: Common (BR-COM-10#1, BR-OTH-02)

|*cbc:UUID* |Identifier |0..1 |A universally unique identifier that can be used to reference this ESPD document instance. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr92-013[_tbr92-013_].

*Rule*: If the referenced document has a UUID to identify its particular instance, refer to that UUID here.

|*cbc:DocumentTypeCode* |Code |1 |The type of document being referenced, expressed as a code. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: For the ESDP-EDM it is compulsory to use the Code List "docref-content-type". See the example below on how to specify the OJS Contract Notice. If, for other documents, the type of document is not available in this list, provide the code "Other" and describe the content in the element DocumentType.

*Rule scope*: Common (BR-OTH-01, BR-OTH-01#3, BR-OTH-03)

|*cbc:DocumentType* |Text |0..1 |The type of document being referenced, expressed as text. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: The attribute "languageID" may be used optionally to indicate the language of the text. Use the Code List "Language" for the value of the languageID attribute.

*Rule scope*: Common (BR-OTH-01, BR-OTH-01#4, BR-OTH-03)

|*cbc:IssueDate* |Date |0..1 |Date when the document was issued by the buyer. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr92-013[_tbr92-013_].

*Rule*: Format "YYYY-MM-DD". If the data of publication by the buyer is available in the referenced document, place it here. 

|*cbc:IssueTime* |Time |0..1 |Time when the document was issued by the buyer. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-002[_tbr92-013_].

*Rule*: If the time of publication by the buyer is available in the referenced document, place it here.

|===

Beware that the ESPD document does not embed the content of referenced documents, instead it make a reference to its source. Thus the class 'DocumentReference' aggregates a 'cac:Attachment' class that allows for embedding the content or making reference to an external source of the content. This is the preferred way in the ESPD (see the XSD schema above):

The mapping between the business requirements, the logic layer of the ESPD-EDM, and the UBL-2.3 physical layer:

[cols=",",options="header",]


_Table 7. External Reference_
|===
|*Component name*: |cac:ExternalReference
|*Definition*: |A reference to the authentic source of content of this document.
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest
/cac:AdditionalDocumentReference
/cac:Attachment/cac:ExternalReference
|===

[cols="1,1,1,3,3"]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:URI* |Identifier |0..1 |The Uniform Resource Identifier (URI) that identifies where the document is located. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: None.

|*cbc:FileName* |Text |0..1 |The title of the document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: Originally this field was the placeholder for the name of the file (e.g. PLACE-ContractNotice-2017-12452.xml). However, as the UBL component does not have a placeholder for a name or title, ESPD documents use it for a short descriptive title of the document being referenced.

|*cbc:Description* |Text |0..n |Short description of the document. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-007[_tbr070-007_].

*Rule*: If the document being referenced is a Notice being published on TED, use two description lines. Use the second description line to for the temporary number received from TED. See example and comments below.

*Rule scope*: Common (BR-COM-10#2, BR-COM-10-S10, BR-COM-10-S20, BR-COM-10-S30)

|===

=== XML Example

The XML snippet below illustrates how to use the cac:AdditionalDocumentReference in the ESPDRequest XML document to refer to a Contract Notice published in TED and on a national procurement board:

[source,xml]
----
<!--- Root elements eliminated for the sake of brevity -->

<!-- Reference to the Contract Notice published on TED -->

<cac:AdditionalDocumentReference>

<cbc:ID schemeAgencyID="OP">2017/S 142-293520</cbc:ID>

<cbc:DocumentTypeCode listID="http://publications.europa.eu/resource/authority/docrefcontent-type" listAgencyID="OP" listVersionID="20220928-0">TED_CN</cbc:DocumentTypeCode>

<cac:Attachment>

<cac:ExternalReference>

<!-- Beware XML URI fields may require encoded URLs -->

<cbc:URI schemeAgencyID="OP">http://ted.europa.eu/udl?uri%3DTED:NOTICE:293520-2017:TEXT:EN:HTML%026src%3D0</cbc:URI>

<cbc:FileName>Spain-Zamora: Repair and maintenance services</cbc:FileName>

<cbc:Description>Repair and maintenance services. Real estate services.</cbc:Description>

<cbc:Description>293520-2017</cbc:Description>

</cac:ExternalReference>

</cac:Attachment>

</cac:AdditionalDocumentReference>

<!-- Reference to the Contract Notice published on the Spanish Central Government eTendering Platform -->

<cac:AdditionalDocumentReference>

<!-- Contract Notice publishied on the Spanish Central eTendering Platform "PLACE" Plataforma de Contratación del Sector Público -->

<cbc:ID schemeAgencyID="PLACE">3.17/20830.0160</cbc:ID>

<!-- Contract Notice (CN) published on a National Government Official Journal -->

<cbc:DocumentTypeCode listID="http://publications.europa.eu/resource/authority/docrefcontent-type" listAgencyID="OP" listVersionID="20220928-0">NOJCN</cbc:DocumentTypeCode>

<cac:Attachment>

<cac:ExternalReference>

<!-- Beware XML URI fields may require encoded URLs -->

<cbc:URI schemeAgencyID="PLACE">https://contrataciondelestado.es/wps/portal/!ut/p/b1/pY_LDoIwEEW_hQ8wM5S2wJKH5REUVEDbjenCGI3Axvj9gmFrMXF2Nzkncy8okDahHD2XMAYnUL1-3a76eRt6_Ziy4me6LqNIpAS9gxMjKeKm4ekUyQhIA5AQo5-w2WdORNu8rfghSxCzVMRFY7NR57_5-OUC_K-_t9j_CMqMkBkwTfwAhg3bdOguIEfMPQfthedkvoNluB8f5dWmrhJiI3KoQYbhEkYnLA-hUw8hhJ_dqV7pwLLeHJySpA!!/</cbc:URI>

<cbc:FileName>Suministro y transporte de balasto</cbc:FileName>

<cbc:Description>Suministro y transporte de balasto para el tramo Zamora — Pedralba de la Línea de Alta Velocidad Olmedo — Lubián — Ourense. Subtramo 8.</cbc:Description>

</cac:ExternalReference>

</cac:Attachment>

</cac:AdditionalDocumentReference>

</QualificationApplicationRequest>
----

. For TED Notices, the Publications Office Official Journal Supplement number must be used in its original format [][][][]/S [][][]-[][][][][][], e.g. 2017/S 142-293520. Notice that the schemeAgencyID is OP (OP standing for 'Publications Office').
. The jurisdiction scope of this document is typified in the Code List docref-content-type (see file link:{url-tree}/codelists/gc/DocRefContentType.gc[/codelists/gc/DocRefContentType.gc] in the distribution package). *Beware that the name and content of this Code List has changed from the previous ESPD-EDM version 2.1.1*.
. The actual content is never embedded in the ESPD documents. Rather the content is always referenced from its original source (alignment with the Once-Only-Principle).
. The title of the CN must be placed in the FileName field of the attachment. UBL does not provide a placeholder for the title of the document.
. If publication on TED is at the ESPD Request preparation time, and the procurer does not yet have the OJS number, they can receive a temporary CN identifier (Received Notice Number). To save this number in the DocumentReference component, two cbc:Description elements must be created, and the second one used for the Received Notice Number. If you do not have a description for the CN then use dummy content for the first description, e.g. <cbc:Description>_</cbc:/Description>.
. schemeAgencyID is used in this example to specify that the national Agency that created this reference to the national publication (e.g., "PLACE" to refer to the ID of the national electronic board where the CN was published). The pattern of the ID is the one created by the Spanish buyer.
. In this case, the code NOJCN means 'Contract Notice (CN) published on a National Government Official Journal' (see file link:{url-tree}/codelists/gc/DocRefContentType.gc[/codelists/gc/DocRefContentType.gc] in the distribution package).

== Contracting Body

=== Related information requirements

See formal requirements related to the contracting authorities in the e-Sens site: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-001[_tbr070-001_]*

=== Mock-up

In principle, the ESPD-EDM asks for a few data about the procurer (i.e. the buyer, body or entity). The essential (compulsory) data for the contracting body are namely the one aimed to identify it, i.e. its official name and the country. The figure below represents a possible GUI interface for these two data. However the UBL specification provides many other data elements some of which may be interesting to include in the ESPD, notably data about the means to contact the contracting body (see below the list of elements possible in the ESPD).

Therefore software applications may make use of the richness of UBL-2.3 to collect data about the buyer contact, end-point, and other possible data in the ESPD.

image:Procurer_identification_mockup.jpg[Procurer identification,width=600,height=100]

_Figure 17. Data about the procurer, mock-up_

=== XSD Schema

The UBL-2.3 model provides a component that fits the purpose of holding data about the procurer: the common aggregate component cac:ContractingParty.

image::https://kroki.io/blockdiag/svg/eNrNU9Fu0zAUfc9XXJkXkEyaVJNWOoG0wiJN4qFamTQJTZFj3yYGxw62U5pNe-cr-Di-ZE5CV1SxCXjixbKP7_E9xz4ulOGfhWQl3EaTCSxZiTDxyCstOVPDLLf4pUXn48rXCs7rg5Jc9oibcMbfGu0t417qcsms7_Kr1bt8xSusWV4qUzCVb6STRsefmhKeZ7JsLUI6iyGQ54dsCGwY2RRGOoz0F73UFXpwDdNQo7dyGwEMy_yrFL6C13A0O3nAKpRl5QOYTgdQ4Jq1yufr0NLJG-x3jk6iqLSmbeAGrcnH6W0UkUNdH7oGCXx0FWt6YqjTAkVhthR2vdNXCXW-U_2-YK5CQYEbZWxYk2eLNMumKbkODffgWZJlp8ckYITAyzdAcOvnl4v3Z1uPujftCAXCCz5ftB3apTVrqfDy4jxIEbI_QxuN1zv27y70p_B9NQXFClR9_ySOf3z7Th7jn4ZxI333j_QLbCw61J754GTQQceiQdiBhejPvdMnnNLHXdC_VhjdRbvQjY_sTVAr0NFdmGDDVIsgXQjZrL-Hh4SE71UbLX6JR0JhH8kkBOE_dPx0wqfHvey7e7eja0Q=[cac:ContractingParty XSD Schema, global vision,width=500,height=300]
//image:cacContractingParty_XSD_Schema_global_vision.jpg[cac:ContractingParty XSD Schema global vision,width=400,height=286]
//[Edit this diagram](https://niolesk.top/#https://kroki.io/blockdiag/svg/eNrNU9Fu0zAUfc9XXJkXkEyaVJNWOoG0wiJN4qFamTQJTZFj3yYGxw62U5pNe-cr-Di-ZE5CV1SxCXjixbKP7_E9xz4ulOGfhWQl3EaTCSxZiTDxyCstOVPDLLf4pUXn48rXCs7rg5Jc9oibcMbfGu0t417qcsms7_Kr1bt8xSusWV4qUzCVb6STRsefmhKeZ7JsLUI6iyGQ54dsCGwY2RRGOoz0F73UFXpwDdNQo7dyGwEMy_yrFL6C13A0O3nAKpRl5QOYTgdQ4Jq1yufr0NLJG-x3jk6iqLSmbeAGrcnH6W0UkUNdH7oGCXx0FWt6YqjTAkVhthR2vdNXCXW-U_2-YK5CQYEbZWxYk2eLNMumKbkODffgWZJlp8ckYITAyzdAcOvnl4v3Z1uPujftCAXCCz5ftB3apTVrqfDy4jxIEbI_QxuN1zv27y70p_B9NQXFClR9_ySOf3z7Th7jn4ZxI333j_QLbCw61J754GTQQceiQdiBhejPvdMnnNLHXdC_VhjdRbvQjY_sTVAr0NFdmGDDVIsgXQjZrL-Hh4SE71UbLX6JR0JhH8kkBOE_dPx0wqfHvey7e7eja0Q=)
_Figure 18. cac:ContractingParty XSD Schema, global vision_

The cac:ContractingParty class is a specialisation of cac:Party. Hence, the main data about the procurer is in this associated cac:Party component:

image:cacParty_XSD_Schema_global vision.jpg[cac:Party XSD Schema, global vision,width=254,height=718]

_Figure 19. cac:Party XSD Schema, global vision_

The cac:Party class in turn associates a very rich class that holds the data about the Party address, including the country (see the UBL-2.3 specification for the complete list of fields):

image:cacPostalAddress,_XSD_Schema.jpg[cac:PostalAddress, XSD Schema,width=566,height=385]

_Figure 20. cac:PostalAddress, XSD Schema_

Notice also that the class associated to cac:Party to place the data about how to contact the contracting body:

image:cacContact_XSD_Schema.jpg[cac:Contact, XSD Schema,width=407,height=253]

_Figure 21. cac:Contact, XSD Schema_

=== Expected elements

The mapping between the business requirements, the logic layer of the ESPD-EDM and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 8. Contracting body, expected elements_
|===
|*Class name*: |cac:ContractingParty
|*Definition*: |The buyer or contracting entity who is buying supplies, services or public works using a tendering procedure as described in the applicable directive (e.g. Directives 2014/24/EU, 2014/25/EU).
|*Business rule(s)*: |Common (BR-REQ-20#1)
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/cac:ContractingParty
|===

[cols="1,1,1,3,3"]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:BuyerProfileURI* |Identifier |0..1 |URL of the web section, in the contracting body web site, that contains information about the contracting body, the norms applied when contracting, published calls for tenders, Prior Information Notices and Contract Notices as well as the related procurement documents, contract award notices, etc. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: Notices published at national level shall not contain information other than that contained in the notices dispatched to the Publications Office of the European Union or published on a buyer profile, but shall indicate the date of dispatch of the notice to the Publications Office of the European Union or its publication on the buyer profile (Directive link:https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32014L0024&from=ES[2014/24/EU, Art. 52.2]).

|===

The mapping between the business requirements, the logic layer of the ESPD-EDM and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 9. Contracting body party, expected elements_
|===
|*Class name*: |cac:Party
|*Definition*: |Main data placeholder structure for, in this case, the contracting body.
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/cac:ContractingParty/cac:Party
|===

[cols="1,1,1,3,3"]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cac:PartyIdentification/cbc:ID* |Identifier |1 |The national identifier of a contracting body as it is legally registered (e.g. VAT identification). a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-001[_tbr070-001_].

*Rule*: When possible, use the VAT identification of the contracting body (see the link:https://ec.europa.eu/taxation_customs/vies/[VIES] platform for a EU cross-border national VAT number verification system). When not possible, a different identifier may be used. The code list link:{url-tree}/codelists/gc/EOIDType.gc[EOIDType] may be used to indicate the type of identifier used as a value of the schemeID attribute, e.g. schemeID="VAT").

*Rule scope*: Common (BR-REQ-20#4, BR-OTH-02)

|*cbc:WebsiteURI* |Identifier |0..1 |The website of the contracting body. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: For online services (e.g. Web Services, REST services, etc. use the component cac:EndPointID.

|*cbc:EndPointID* |Identifier |0..1 |Electronic address of the contracting body. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-001[_tbr070-001_].

*Rule*: Use it for online services (e.g. Web Services, REST services, Delivery ID, ftp, etc. For the official web site of the Party use always the cac:Party/cbc:WebsiteURI). An end-point identifier MUST have a scheme identifier attribute (e.g.eSENSParty Identifier Scheme). Should be considered for all actors (buyer, service provider, economic operator) as an eDeliveryID.

|*cac:PartyName/cbc:Name* |Text |1 |The name of the contracting body as it is registered. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-001[_tbr070-001_].

*Rule*: Mandatory. Use the official name of the contracting body. The PartyName class has an associated basic element "cbc:Name". See XML example below.

*Rule scope*: Common (BR-REQ-20#2)

|===

The mapping between the business requirements, the logic layer of the ESPD-EDM and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 10. Contracting body postal address, expected elements_
|===
|*Class name*: |cac:PostalAddress
|*Definition*: |Contractinng body address information.
|*Business rule(s)*: |None
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/
cac:ContractingParty/cac:Party/cac:PostalAddress
|===

[cols="1,1,1,3,3"]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:StreetName* |Text |0..1 |The main address line in an address. Usually the street name and number or post office box. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cbc:CityName* |Text |0..1 |The common name of a city where the address is located. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cbc:PostalZone* |Text |0..1 |The identifier for an addressable group of properties according to the relevant postal service, such as a ZIP code or Post Code. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cac:Country/cbc:
IdentificationCode* |Code |1 |A code that identifies the country. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: The country of the contracting body must always be specified. Compulsory use of the code list Country from EU Vocabularies).

*Rule scope*: Common (BR-REQ-20#3, BR-OTH-01, BR-OTH-01#5, BR-OTH-03)

|*cac:Country/cbc:Name* |Text |0..1 |The name of the country. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|===

The mapping between the business requirements, the logic layer of the ESPD-EDM and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 11. Contact of the contracting body, expected elements_
|===
|*Class name*: |cac:Contact
|*Definition*: |Used to provide contacting information for a party in general or a person.
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/
cac:ContractingParty/cac:Party/cac:Contact
|===

[cols="1,11,3,3,"]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:Name* |Text |0..1 |The name of the contact point. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cbc:Telephone* |Text |0..1 |A phone number for the contact point. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cbc:Telefax* |Text |0..1 |A fax number for the contact point. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|*cbc:ElectronicMail* |Text |0..1 |An e-mail address for the contact point. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-006[_tbr070-006_].

*Rule*: None.

|===


== Service Provider

[cols=",",]
|===
|*REQUIREMENT* link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-011[_tbr070-011_] |*The ESPD request may contain information of identification regarding an ESPD service provider: Name, Party Identification, Endpoint ID.*
|===

Service providers are officially recognised organisations that can supply ESPD Request documents (on behalf of the contracting body) with pre-filled information about the contracting body and additional information (e.g. liability statements, see link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-012[_tbr070-012_])

The ESPD allows the provision of data about the service provider who produced the ESPD Request document (and equally for the ESPD Response document, on behalf of the economic operator).

Since the 2.1.1 does not include the cac:ServiceProvider as a 'document root component'. Instead, it uses the UBL-2.3 cac:ContractingParty/cac:Party associated class cac:ServiceProviderParty.

=== XSD Schema

image:cacServiceProvider_XSD_Schema.jpg[cac:ServiceProvider XSD Schema,width=566,height=453]

_Figure 22. cac:ServiceProvider XSD Schema_

*Notice that*:

[arabic]
. The cac:Party class aggregates the class cac:ServiceProviderParty; and
. The cac:ServiceProviderParty class 'is a' Party. Hence it aggregates a cac:Party class too, and uses it to place the main data about the service provider (like name, address, end-point, etc.).

image:cacServiceProvider.jpg[cac:ServiceProvider,width=514,height=217]

_Figure 22. cac:ServiceProvider_

image:cacService_provider_Party_elements.jpg[service provider's 'Party' elements,width=506,height=524]

_Figure 23. cac:ServiceProvider/cac:Party elements expected for the service provider_

=== Expected elements

The mapping between the business requirements, the logic layer of the ESPD-EDM and the UBL-2.3 physical layer:

[cols=",",options="header",]

_Table 12. Service provider, expected elements_
|===
|*Class name*: |cac:Party
|*Definition*: |Main information about the service provider.
|*Business rule(s)*: |None
|*File*: |ubl-2.3/xsdrt/common/UBL-CommonAggregateComponents-2.3.xsd
|*Path*: |/QualificationApplicationRequest/
cac:ContractingParty/cac:Party/cac:ServiceProviderParty/
cac:Party
|===

[cols="1,1,1,3,3",options="header",]
|===
|*Components* |*Type* |*Card* |*Description* |*Requirements*
|*cbc:WebsiteURI* |Identifier |0..1 |The website of the service provider. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-011[_tbr070-011_].

*Rule*: Use it for the official web site of the service provider. Reserve the EndPointID for online services (e.g. web, REST, ftp services, etc.)

|*cbc:EndpointID* |Identifier |0..1 |Electronic address of the service provider. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-0011[_tbr070-011_].

*Rule*: Use it for online services (e.g. Web Services, REST services, Delivery ID, ftp, etc. For the official web site of the Party use always the cac:Party/cbc:WebsiteURI). An end-point identifier MUST have a scheme identifier attribute (e.g.eSENSParty Identifier Scheme). Should be considered for all actors (buyer, service provider, economic operator) as an eDeliveryID.

|*cac:PartyIdentification/cbc:ID* |Identifier |1 |The national identifier of a service provider as it is legally registered (e.g. VAT identification). a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-0011[_tbr070-011_].

*Rule*: An identifier for the service provider must always be provided. Compulsory use of the attribute SchemeAgencyID. When possible use the VAT identification of the service provider (see the VIES platform for a EU cross-border national VAT number verification system). See XML example below. The code list link:{url-tree}/codelists/gc/EOIDType.gc[EOIDType] may be used to indicate the type of identifier used as a value of the schemeID attribute, e.g. schemeID="VAT").

*Rule scope*: Common (BR-REQ-20#5, BR-OTH-02")

|*cac:PartyName/cbc:Name* |Text |1 |The name of the service provider. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-0011[_tbr070-011_].

*Rule*: The name of the service provider must always be specified. Supply the official registered name of the service provider.

*Rule scope*: Common (BR-REQ-20#6)

|*cac:PostalAddress/
cac:Country/cbc:
IdentificationCode* |Code |1 |The code that identifies the country of the service provider. a|
*Information Requirement*: link:http://wiki.ds.unipi.gr/display/ESPDInt/BIS+41+-+ESPD+V2.1.0#BIS41-ESPDV2.1.0-tbr070-0011[_tbr070-011_].

*Rule*: The country of the service provider must always be specified. Compulsory use of the code list "Country" from EU Vocabulary, which includes 3-character codes and it is based on ISO.

*Rule scope*: BR-REQ-20#7, BR-OTH-01, BR-OTH-01#5, BR-OTH-03

|===

=== XML example

The XML snippet below shows how an example of how to supply the expected data for the service provider.

[source,xml]
----
...

_<!--- Root elements eliminated for the sake of brevity -->_

<cac:ContractingParty>

<cac:Party>

<cac:PartyIdentification><cbc:ID schemeAgencyID="VIES">B82387770</cbc:ID> </cac:PartyIdentification>

<cac:PartyName><cbc:Name>Ministerio de Defensa</cbc:Name></cac:PartyName>

<cac:PostalAddress><cac:Country><cbc:IdentificationCode listID="http://publications.europa.eu/resource/authority/country" listAgencyID="OP" listVersionID="20220928-0">ES</cbc:IdentificationCode></cac:Country></cac:PostalAddress>

<cac:ServiceProviderParty>

<cac:Party>

<cbc:WebsiteURI>http://www.minhafp.gob.es/es-ES/Areas%20Tematicas/Patrimonio%20del%20Estado/Contratacion%20del%20Sector%20Publico/Paginas/ROLECE.aspx</cbc:WebsiteURI>

<cbc:EndpointID>http://www.minhafp.gob.es/ESPD/endpoint</cbc:EndpointID>

<cac:PartyIdentification>

<cbc:ID schemeAgencyID="AEAT">B36699932</cbc:ID>

</cac:PartyIdentification>

<cac:PartyName>

<cbc:Name>Registro Oficial de Licitadores y Empresas Clasificadas (ROLECE)</cbc:Name></cac:PartyName>

<cac:PostalAddress>

<cac:Country><cbc:IdentificationCode listID="http://publications.europa.eu/resource/authority/country" listAgencyID="OP" listVersionID="20220928-0">ESP</cbc:IdentificationCode></cac:Country>

</cac:PostalAddress>

</cac:Party>

</cac:ServiceProviderParty>

</cac:Party>

</cac:ContractingParty>

...
----


. ContractingParty non-compulsory elements have been omitted for the sake of brevity.
. The service provider VAT number. The issuer Agency is the Spanish Tax Agency (AEAT). You can use the VIES platform to verify that the VAT number exists and is correct for Spain.
. The registered name of the service provider is mandatory.
. The country code of the service provider (ESP) is compulsory. You will need to use this code (ESP) to verify the VAT number in the VIES service.

include::partial$feedback.adoc[]

