:doctitle: ESPD Architecture and Procurement Procedure Steps
:doccode: espd-tech-prod-032
:author: NPJ
:authoremail: nicole-anne.paterson-jones@ext.ec.europa.eu
:docdate: January 2024

== ESPD Architecture Overview 

The purpose of the ESPD Exchange data model (ESPD-EDM) is to assist developers in the creation of an ESPD Service by providing a model. This ensures that the ESPD Request and the ESPD Response files produced across all ESPD Services are consistent, and comply with the relevant legislation. 

Key components and standards were adopted in alignment with related projects in European public procurement such as EU Vocabularies and eCertis:

* UBL
* UML
* A data structure
* XSL(T)
* XML 

Below is a high level overview of the ESPD Architecture. 

image:ESPD_Architecture_Overview.jpg[ESPD Architecture Overview,align="center",width=650,height=500]

Image as code 1
image::https://kroki.io/pikchr/svg/eNq1lttum0AQhu95ilGqSIlq0IKhdnJRCRYSRUqVNk6iSlUvsFknKxHWXbCTvn1nWeISTnYPkS9s1vibmf-fGeyfwjffPoW5eAYZJ-CtnuHg9tPlARxEs8-hGYWfzGuWr0SWMzO4ujuAhUiFBPJsnzjUpbDkaYpXvqdeeFUYsZTiCcyP2zv1d4bv7BnmZq8wyItPQQfj2YbnfJ4ySMRTBg45hKUUj-DbVg6GP_6v9Ul-_zBQpfs_q_xuBEImTGpm8cAzeOJJ8QC-Vb6_J5aHZw9M5YSH-kN1GquTBcsKJg1DCVMlbduoTztzI8BeMAK31Q3BJRxd-bOLGdxmfMNkHqcQrHOesTyHyzi7X8f37BiL_LKOU77ki7jgIvNXq7T6eM1-rFleWM950lfyhPih-6HUt5ap9zpRfROm6LxBitqWPXM0vqMPaIPFtMoM3sOROyLH0GdY0GVY0DIs2BpGlRvUbrqhGgkqQbGeMC5imBVyvSjWkvVl7rqTMR3sXi8-mScexnOG431V3bwzSD--OYpfZ5c3cMZTdpQre2BveN_Io2Jq5jGU112J9vktpPuwI-C_ajf5d-12iucp8ag97SqFioSl_A_aLnDpJNpPu5MdAQe0q0Xp5TukrV0p3ZBuNfB23sshXXKZF4qHYplwREbEmvZPPu2afNqafLqd_FBNfnjuDo0-qJWHolRF7Ha-3KqPYsPA8Q4V3Rnq1j_G18njIS_hnGVM8gVQnrASn_fyawbU-c0n7B2u9KTc4ujGhdJQrJiM5zzlxU-4UWoFLOmNcuYGztTpsDnAN1zrxHJGYNrW1DuGXpPDLpPDlsnhi8nvuh4fJrFs7CMjUg0QOS3_b7FX78Qinq_TWHIlXE9FZ5QQgoSmx4wyWfAdv1Mp2VAOLIglrCTbcLHOEdc0ln2--ltU00N2JuTjXyfWXPU3UdiHmrpjSmiJspxOWHONX7N71Fu1145F0ZvepGMg0MoZkxu-YHsUbU07uK96lepVZDoWGYF93NemUVebRq02jba7SG_U8uGA_2BUm2KTYggcChyHQpTNq3agOjT1aePvWh_C7GTsRuR6KO2T0W9CaGVl-fumkb_k4Xg1CtV56GOFcWsYvezqGKrnVt-NkatMnnQtFYIMESK9YczxKwTVJeLK2Z6-IKrJ7kA4lkfaCFKeNgRpQ8IXUSd1OaJK1LHluYhuAn4Ba7ks5g==[Diagram]

////
A: [A1: box rad 5px "UML" "ESPD-EDM-Response-BOV" color 0x192C4C fill 0xA5A5A5 fit
arrow -> color 0xA5A5A5
A2: box rad 5px "UML" "ESPD-EDM-Response-TOV" color 0x192C4C fill 0xA5A5A5 fit

A2a: arrow invisible down 20% from A1.s 
A3: box rad 5px "UML" "ESPD-EDM-Response-BOV" color 0x192C4C fill 0xA5A5A5 fit
right
arrow -> color 0xA5A5A5
A4: box rad 5px "UML" "ESPD-EDM-Response-TOV" color 0x192C4C fill 0xA5A5A5 fit]
Border: box thin width A.width+0.5in height A.height+0.5in at A.center

down
arrow 110% -> color 0xA5A5A5

B: [
B41: box rad 5px "UBL (OASIS Universal Business Language)" "QualificationApplicationRequest.xsd" color 0x192C4C fill 0x70AD46 fit
down
arrow 50% -> color 0x70AD46
B42: box rad 5px "UBL (OASIS Universal Business Language)" "QualificationApplicationResponse.xsd" color 0x192C4C fill 0x70AD46 fit

] with .e at A.e + (4,0) 
Border: box thin width B.width+0.5in height B.height+0.5in at B.center

C: [
C11: box rad 5px "ESPD Request" "Data Structure" color 0x192C4C fill 0x4473C5 fit
right
arrow -> color 0x5a9bd5
C12: box rad 5px "ESPD Request" "XML" color 0x192C4C fill 0x4473C5 fit
arrow -> color 0x5a9bd5
C13: box rad 5px "XSLT File(s)" " " color 0x192C4C fill 0x4473C5 fit
arrow invisible down 20% from C11.s 

C15: box rad 5px "ESPD Response" "Data Structure" color 0x192C4C fill 0x4473C5 fit
right
arrow -> color 0x5a9bd5
C16: box rad 5px "ESPD Response" "XML" color 0x192C4C fill 0x4473C5 fit
arrow -> color 0x5a9bd5
C17: box rad 5px "XSLT File(s)" " " color 0x192C4C fill 0x4473C5 fit

arrow invisible down 20% from C15.s 
C18: box rad 5px "ESPD Codelist" "Data Structure" color 0x192C4C fill 0xB4C7E5 fit
right
arrow -> color 0x5a9bd5
C19: box rad 5px "ESPD Codelist" "XML" color 0x192C4C fill 0xB4C7E5 fit
arrow -> color 0x5a9bd5
C20: box rad 5px "XSL File" " " color 0x192C4C fill 0xB4C7E5 fit

] with .n at first box.s - (0,0.8) 
Border: box thin width C.width+0.5in height C.height+0.5in at C.center

D: [
DG41: box rad 5px "ESPD Request UBL XML File"  color 0x192C4C fill 0x4473C5 fit
down
move 25%
DG42: box rad 5px "ESPD Response UBL XML File"  color 0x192C4C fill 0x4473C5 fit
move 25%
DG43: box rad 5px "ESPD Codelist Generic Cide Files"  color 0x192C4C fill 0xB4C7E5 fit
move 25%
DG44: box rad 5px "Validation - Interoperability Test Bed"  color 0x192C4C fill 0xF4B282 fit

] with .n at B.n + (0.2, -1.85)  
Border: box thin width D.width+0.5in height D.height+0.5in at D.center
#with .e at A.e + (4,-0.1) 

E: [
E21: box rad 5px "EU" "Vocabularies" color 0x192C4C fill 0xFFC000
E22: box rad 5px "eCertis" color 0x192C4C fill 0xFFC000 at 1 right of previous
E23: box rad 5px "ePO" color 0x192C4C fill 0xFFC000 at 1 right of previous
E24: box rad 5px "eForms" color 0x192C4C fill 0xFFC000 at 1 right of previous
E25: box rad 5px "TED" color 0x192C4C fill 0x843C0C at 1.2 right of previous
E26: box rad 5px "Regulation" color 0x192C4C fill 0xB4C7E5 at 1 right of previous
E27: box rad 5px "ESPD" "Service" color 0x192C4C fill 0xFFC000 at 1.8 right of previous
] with .n at C.s - (-2.0, 1)
Border: box thin width E.width+0.5in height E.height+0.5in at E.center

arrow from B.w + (-0.0, 0.25) to A.e - (0.0, -0.25) color 0x70AD46
arrow from B.w + (-0.0, -0.25) to A.e - (0.0, 0.25) color 0x70AD46
arrow from B.s + (0.19,-0.25) to D.n - (-0.0, -0.25) color 0x70AD46
arrow from B.sw + (-0.25,-0.25) to C.e - (-0.25, -0.45) color 0x4473C5
arrow from C.e + (0.25, 0.0) to D.w - (0.25, -0.0) color 0x4473C5
arrow from E.n + (-3.25, 0.0) to C.s + (-1.25, 0.0) color 0xFFC000
arrow from E.n + (-2.50, 0.0) to C.s + (-0.50, -0.25) color 0xFFC000
arrow from D.s + (0.75,-0.25) to E.n - (-3.54, 0) color 0xFFC000

[Edit this diagram](https://niolesk.top/#https://kroki.io/pikchr/svg/eNq1lttum0AQhu95ilGqSIlq0IKhdnJRCRYSRUqVNk6iSlUvsFknKxHWXbCTvn1nWeISTnYPkS9s1vibmf-fGeyfwjffPoW5eAYZJ-CtnuHg9tPlARxEs8-hGYWfzGuWr0SWMzO4ujuAhUiFBPJsnzjUpbDkaYpXvqdeeFUYsZTiCcyP2zv1d4bv7BnmZq8wyItPQQfj2YbnfJ4ySMRTBg45hKUUj-DbVg6GP_6v9Ul-_zBQpfs_q_xuBEImTGpm8cAzeOJJ8QC-Vb6_J5aHZw9M5YSH-kN1GquTBcsKJg1DCVMlbduoTztzI8BeMAK31Q3BJRxd-bOLGdxmfMNkHqcQrHOesTyHyzi7X8f37BiL_LKOU77ki7jgIvNXq7T6eM1-rFleWM950lfyhPih-6HUt5ap9zpRfROm6LxBitqWPXM0vqMPaIPFtMoM3sOROyLH0GdY0GVY0DIs2BpGlRvUbrqhGgkqQbGeMC5imBVyvSjWkvVl7rqTMR3sXi8-mScexnOG431V3bwzSD--OYpfZ5c3cMZTdpQre2BveN_Io2Jq5jGU112J9vktpPuwI-C_ajf5d-12iucp8ag97SqFioSl_A_aLnDpJNpPu5MdAQe0q0Xp5TukrV0p3ZBuNfB23sshXXKZF4qHYplwREbEmvZPPu2afNqafLqd_FBNfnjuDo0-qJWHolRF7Ha-3KqPYsPA8Q4V3Rnq1j_G18njIS_hnGVM8gVQnrASn_fyawbU-c0n7B2u9KTc4ujGhdJQrJiM5zzlxU-4UWoFLOmNcuYGztTpsDnAN1zrxHJGYNrW1DuGXpPDLpPDlsnhi8nvuh4fJrFs7CMjUg0QOS3_b7FX78Qinq_TWHIlXE9FZ5QQgoSmx4wyWfAdv1Mp2VAOLIglrCTbcLHOEdc0ln2--ltU00N2JuTjXyfWXPU3UdiHmrpjSmiJspxOWHONX7N71Fu1145F0ZvepGMg0MoZkxu-YHsUbU07uK96lepVZDoWGYF93NemUVebRq02jba7SG_U8uGA_2BUm2KTYggcChyHQpTNq3agOjT1aePvWh_C7GTsRuR6KO2T0W9CaGVl-fumkb_k4Xg1CtV56GOFcWsYvezqGKrnVt-NkatMnnQtFYIMESK9YczxKwTVJeLK2Z6-IKrJ7kA4lkfaCFKeNgRpQ8IXUSd1OaJK1LHluYhuAn4Ba7ks5g==)
////

_Figure 10. ESPD Architecture Overview_

The ESPD Architecture components interact with each other to produce the final ESPD UBL XML Request and Response. 

* *The UBL (Universal Business Language) component* 

This describes the UBL language that is used to define the ESPD Request and Response XML elements, and attributes of XML elements. 

* *The UML component* 

This describes the Request and the Response model elements and their attributes, relationships between elements, and relationship cardinalities. There is a BOV (Business Oriented View) model and a TOV (Technical Oriented View) model. The TOV describes the UBL layer. 

* *The ESPD Criterion Data Structure component* 

This describes each Request and Response criterion and its hierarchical tree structure of descriptive elements. It is maintained in MS Excel format file then transformed (saved) into an ODS (Open Document) file, from which an initial XML file is extracted. From the XML file an ESPD UBL XML file is generated using XSLT transformation rules. 

* *The ESPD UBL XML component*

This describes the resulting ESPD UBL XML files for the Request (generated by the Buyer or CA -contracting authority-) and for the Response (generated by the EO -economic operator-). These are generated by XSLT transformations applied to the related Criterion ODS XML file. 

* *The ESPD Codelists Data Structure component* 

This describes, in MS Excel format, the attribute-value structure of the codes for each code list used in the ESPD project. The MS Excel file is transformed (saved) as an XML Spreadsheet file, from which the ESPD Codelist Generic Code files are generated using XSL transformation rules. 

* *The ESPD Codelists generic code component*

This describes the resulting ESPD Codelists generic code files produced by the XSL transformations applied to the related Codelists XML file. 

* *The ESPD Validation component*. 

This validates the generated files produced (ESPD Request UBL XML, ESPD Response UBL XML, ESPD Codelists Generic Code) against a UBL schema and a set of ESPD specific rules. 


== ESPD Procurement Procedure Steps 

The set of tasks for the whole procurement procedure are summarised in the following figures. 

The Buyer or the Contracting Authority (CA) initiates a procurement procedure. 

image:ESPD_Buyer_Plan.jpg[Buyer Planning,align="center",width=650,height=500]

Image as code 2
image::https://kroki.io/pikchr/svg/eNqNzk0OwiAQBeB9TzHhAA0oxNilpHFnvAJFbCciGBwVby_xJ2lYuXzJm-8NuUzANrenSx0DG31MMHhjT8053h0kHCcC3ioMTb8VHQwxQzIHUJcMbO9NCBjG3yHPYr3QUsMRvS9JytVSq5JoromWfzRTcbtIaN31D43eX9fzjwnJgSEo9rdSkfOGeQEdYk-v[Diagram]

////
text "Buyer:" color black
move right 0.5in
EG1: box rad 5px "Planning" color 0x192C4C fill 0x4473C5 fit
move right 1.0in
EG1a: box rad 5px "Notices" color 0x192C4C fill 0x4473C5 fit
text "Planning" color white at EG1
text "Notices" color white at EG1a

[Edit this diagram](https://niolesk.top/#https://kroki.io/pikchr/svg/eNqNzk0OwiAQBeB9TzHhAA0oxNilpHFnvAJFbCciGBwVby_xJ2lYuXzJm-8NuUzANrenSx0DG31MMHhjT8053h0kHCcC3ioMTb8VHQwxQzIHUJcMbO9NCBjG3yHPYr3QUsMRvS9JytVSq5JoromWfzRTcbtIaN31D43eX9fzjwnJgSEo9rdSkfOGeQEdYk-v)
////



_Figure 10_a. Buyer Planning_

The Buyer launches a Request. 

image:ESPD_Buyer_Request.jpg[Buyer Request,align="center",width=650,height=500]

Image as code 3
image::https://kroki.io/pikchr/svg/eNqtkcFqwzAMhu95ChEYbJeRdDGjvSahx5blCWRbWc2cKDjyGvb0cxkbPZTSwm76Qf4-SRZaBPLW8MiDM7CbKKBwgMd297TJwbBPQXs0H9nAnwTBvR8EimflxqzdlhvQvEBAC2paEqfbN_BG88TjTNBQj9FLDnmDgtBJiEZioF9ssZTrVV3V0DvvU6qq15dapSQZhsBHKIvi4a9X4VpbdZLiVWsdZ0m7fJH9d7G-Ku6iHpwIWejTO0z2fWCTtAONAqea7G1DyM-n3HXM48EJAQqkOS8CbrjLOQMvQu7c8RyovwGZisnP[Diagram]

////
text "Buyer:" color black
move right 0.5in
EG1: box rad 5px "ESPD Request Default" "Data Structure" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1a: box rad 5px "ESPD Request Customized" "Data Structure" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1b: box rad 5px "ESPD Request Published for a" "Procurement Procedure" color 0x192C4C fill 0x4473C5 fit
text "ESPD Request Default" "Data Structure" color white at EG1
text "ESPD Request Customized" "Data Structure" color white at EG1a
text "ESPD Request Published for a" "Procurement Procedure" color white at EG1b

////

_Figure 10_b. Buyer Request_

Economic Operators (EO) respond to the (officially published) Request. 

image:ESPD_EO_Response.jpg[EO Response,align="center",width=650,height=500]


Image as code 4

image::https://kroki.io/pikchr/svg/eNqtkcFqwzAMhu95ChEYbJeRdDGjvSahx5blCWRbWc2cKDjyGvb0cxkbPZTSwm76Qf4-SRZaBPLW8MiDM7CbKKBwgMd297TJwbBPQXs0H9nAnwTBvR8EimflxqzdlhvQvEBAC2paEqfbN_BG88TjTNBQj9FLDnmDgtBJiEZioF9ssZTrVV3V0DvvU6qq15dapSQZhsBHKIvi4a9X4VpbdZLiVWsdZ0m7fJH9d7G-Ku6iHpwIWejTO0z2fWCTtAONAqea7G1DyM-n3HXM48EJAQqkOS8CbrjLOQMvQu7c8RyovwGZisnP[Diagram]

////
text "Economic Operator (EO):" color black
move right 0.5in
EG1: box rad 5px "ESPD Response Default" "Data Structure" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1a: box rad 5px "ESPD Response Customized" "Data Structure" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1b: box rad 5px "ESPD Response Submitted for a" "Procurement Procedure" color 0x192C4C fill 0x4473C5 fit
text "ESPD Response Default" "Data Structure" color white at EG1
text "ESPD Response Customized" "Data Structure" color white at EG1a
text "ESPD Response Submitted for a" "Procurement Procedure" color white at EG1b

[Edit this diagram](https://niolesk.top/#https://kroki.io/pikchr/svg/eNqtkcFqwzAMhu95ChEYbJeRdDGjvSahx5blCWRbWc2cKDjyGvb0cxkbPZTSwm76Qf4-SRZaBPLW8MiDM7CbKKBwgMd297TJwbBPQXs0H9nAnwTBvR8EimflxqzdlhvQvEBAC2paEqfbN_BG88TjTNBQj9FLDnmDgtBJiEZioF9ssZTrVV3V0DvvU6qq15dapSQZhsBHKIvi4a9X4VpbdZLiVWsdZ0m7fJH9d7G-Ku6iHpwIWejTO0z2fWCTtAONAqea7G1DyM-n3HXM48EJAQqkOS8CbrjLOQMvQu7c8RyovwGZisnP)
////

_Figure 10_c. Economic Operator (EO) Response_

Finally, the Buyer and the EO interact to conclude the procurement procedure. 

image:ESPD_Buyer_EO.jpg[Buyer and EO,align="center",width=650,height=500]

Image as code 5

image::https://kroki.io/pikchr/svg/eNqlkE0OgjAQRvecYkKiS1OUxoArbYhLF55gWqo2FkqaUertRYMGcWPi8su8efNDOhDEm8tNe5hi1ayg2OUxKGedB2lRnaPKXTV4czwRsBk3dVRskxykC-CxBN4EiPfaakXG1a9OFpJsLlIBB2Ntl9J0uRC8SxSh966FhLHJm-WYyZI_vDgSr1v05b9SOZIKV5NHRT946fmer_PakyENSNDZe-Zj02Ede2A8dcjIO328eic=[Diagram]

////
text "Buyer &amp; EO:" color black
move right 0.5in
EG1: box rad 5px "Selection" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1a: box rad 5px "Award" color 0x192C4C fill 0x4473C5 fit
arrow 100% color 0x5a9bd5
EG1b: box rad 5px "Contract" color 0x192C4C fill 0x4473C5 fit
text "Selection" color white at EG1
text "Award" color white at EG1a
text "Contract" color white at EG1b

[Edit this diagram](https://niolesk.top/#https://kroki.io/pikchr/svg/eNqlkE0OgjAQRvecYkKiS1OUxoArbYhLF55gWqo2FkqaUertRYMGcWPi8su8efNDOhDEm8tNe5hi1ayg2OUxKGedB2lRnaPKXTV4czwRsBk3dVRskxykC-CxBN4EiPfaakXG1a9OFpJsLlIBB2Ntl9J0uRC8SxSh966FhLHJm-WYyZI_vDgSr1v05b9SOZIKV5NHRT946fmer_PakyENSNDZe-Zj02Ede2A8dcjIO328eic=)
////

_Figure 10_d. Buyer and EO_
